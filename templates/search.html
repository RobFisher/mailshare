{% load dajaxice_templatetags %}

<html>
<head>
<title>Mailshare Search</title>
<link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}mailshare.css" />
<link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}jquery-ui/jquery-ui-1.8.16.custom.css" />
<script src="{{ STATIC_URL }}jquery.js"></script>
{% dajaxice_js_import %}
<script src="{{ STATIC_URL }}jquery.dajax.core.js" type="text/javascript" charset="utf-8"></script>
<script src="{{ STATIC_URL }}jquery-ui/jquery-ui-1.8.16.custom.min.js"></script>
<script src="{{ STATIC_URL }}mailshare.js"></script>

</head>
<body>
<h1><a href="/">Mailshare Search</a></h1>
<form action="/search/" name="search" method="GET">
<input id="query" name="query" value="{{ search_query }}" />
<input id="submit" type="submit" value="Search" />
</form>

<div class="search_details">
{% if sender_html %}
    <div class="search_sender"><p>Sender is {% autoescape off %}{{ sender_html }}{% endautoescape %}</p></div>
{% endif %}
{% if tag_html %}
    <div class="search_tag"><p>Contains tag {% autoescape off %}{{ tag_html }}{% endautoescape %}</p></div>
{% endif %}
</div>

<p>Tag cloud for these results:</p>
<div class="tag_cloud">
    {% autoescape off %}{{ tag_cloud }}{% endautoescape %}
</div>

{% if results %}
    <table>
    {% for result in results %}
        <tr onclick="toggle_email_body({{ result.id }})" class="mailhead {% cycle 'odd' 'even' %}">
            <td>{{ result.date }}</td>
            <td>{{ result.sender }}</td>
            <td>{{ result.subject }}</td>
        </tr>
	<tr>
	  <td colspan="3" class="mailbody empty" id="body_{{ result.id }}">Email body</td>
	</tr>
    {% endfor %}
    </table>
{% else %}
    <p>No results found.</p>
{% endif %}
</form>    
</body>
</html>
